---
title: Google AI plugin
description: Learn how to use Google's Gemini models with Genkit across JavaScript, Go, and Python through the Google AI Studio API, including text generation, embeddings, image generation, video generation, and text-to-speech.
---

import LanguageSelector from '../../../../components/LanguageSelector.astro';
import CopyMarkdownButton from '../../../../components/CopyMarkdownButton.astro';
import LanguageContent from '../../../../components/LanguageContent.astro';

<div style="display: flex; justify-content: space-between; align-items: center; gap: 1rem; margin: 1rem 0 1rem 0;">
  <LanguageSelector />
  <CopyMarkdownButton />
</div>

<LanguageContent lang="js">

The Google GenAI plugin provides a unified interface to connect with Google's generative AI models through the **Gemini Developer API** using API key authentication. It is a replacement for the previous `googleAI` plugin.

## Installation

```bash
npm i --save @genkit-ai/google-genai
```

## Configuration

```typescript
import { genkit } from 'genkit';
import { googleAI } from '@genkit-ai/google-genai';

const ai = genkit({
  plugins: [
    googleAI(),
    // Or with an explicit API key:
    // googleAI({ apiKey: 'your-api-key' }),
  ],
});
```

**Authentication:** Requires a Google AI API Key, which you can get from [Google AI Studio](https://aistudio.google.com/apikey). You can provide this key by setting the `GEMINI_API_KEY` or `GOOGLE_API_KEY` environment variables, or by passing it in the plugin configuration.

## Usage Examples

### Text Generation

```typescript
import { genkit } from 'genkit';
import { googleAI } from '@genkit-ai/google-genai';

const ai = genkit({
  plugins: [googleAI()],
});

const response = await ai.generate({
  model: googleAI.model('gemini-2.5-flash'),
  prompt: 'Explain how neural networks learn in simple terms.',
});

console.log(response.text);
```

### Text Embedding

```typescript
const embeddings = await ai.embed({
  embedder: googleAI.embedder('gemini-embedding-001'),
  content: 'Machine learning models process data to make predictions.',
});

console.log(embeddings);
```

### Image Generation

```typescript
const response = await ai.generate({
  model: googleAI.model('imagen-4.0-generate-001'),
  prompt: 'A serene Japanese garden with cherry blossoms and a koi pond.',
});

const generatedImage = response.media;
console.log('Image generated:', generatedImage);
```

## Language Models

You can create models that call the Google Generative AI API. The models support tool calls and some have multi-modal capabilities.

### Model Capabilities

The following table shows the capabilities of popular Gemini models:

| Model | Image Input | Object Generation | Tool Usage | Tool Streaming | Thinking | Code Execution | Google Search |
|-------|-------------|-------------------|------------|----------------|----------|----------------|---------------|
| `gemini-2.5-pro` | ✓ | ✓ | ✓ | ✓ | ✓ | ✓ | ✓ |
| `gemini-2.5-flash` | ✓ | ✓ | ✓ | ✓ | ✓ | ✓ | ✓ |
| `gemini-2.5-flash-lite` | ✓ | ✓ | ✓ | ✓ | ✓ | ✓ | ✓ |
| `gemini-2.0-flash` | ✓ | ✓ | ✓ | ✓ | Experimental | ✓ | ✓ |
| `gemini-1.5-pro` | ✓ | ✓ | ✓ | ✓ | - | ✓ | ✓ |
| `gemini-1.5-flash` | ✓ | ✓ | ✓ | ✓ | - | ✓ | ✓ |
| `gemini-1.5-flash-8b` | ✓ | ✓ | ✓ | ✓ | - | ✓ | ✓ |

:::note
See the [Google Generative AI models documentation](https://ai.google.dev/gemini-api/docs/models) for a complete list of available models and their capabilities.
:::

## Available Models

The Google GenAI plugin provides access to various model types for different use cases:

### Text Generation Models

**Gemini 2.5 Series** - Latest models with advanced reasoning and multimodal capabilities:
- `gemini-2.5-pro` - Most capable model for complex tasks
- `gemini-2.5-flash` - Fast and efficient for most use cases
- `gemini-2.5-flash-lite` - Lightweight version for simple tasks
- `gemini-2.5-flash-image` - Supports image generation outputs

**Gemini 2.0 Series** - Previous generation with strong performance:
- `gemini-2.0-flash` - Fast model with good capabilities
- `gemini-2.0-flash-lite` - Lightweight version

**Gemini 1.5 Series** - Stable models with proven performance:
- `gemini-1.5-pro` - High-capability model
- `gemini-1.5-flash` - Fast and efficient
- `gemini-1.5-flash-8b` - Smaller, faster variant

**Gemma 3 Series** - Open models for various use cases:
- `gemma-3-27b-it` - Large instruction-tuned model
- `gemma-3-12b-it` - Medium instruction-tuned model
- `gemma-3-4b-it` - Small instruction-tuned model
- `gemma-3-1b-it` - Tiny instruction-tuned model
- `gemma-3n-e4b-it` - Efficient 4-bit model

### Embedding Models

- `gemini-embedding-001` - Latest Gemini embedding model (3072 dimensions, customizable)
- `text-embedding-004` - Text embedding model (768 dimensions, customizable)

### Image Generation Models

**Imagen 4 Series** - Latest generation with improved quality:
- `imagen-4.0-generate-001` - Standard quality image generation
- `imagen-4.0-ultra-generate-001` - Ultra-high quality image generation
- `imagen-4.0-fast-generate-001` - Fast image generation

**Imagen 3 Series** - Previous generation:
- `imagen-3.0-generate-002` - High-quality image generation

### Video Generation Models (Veo)

- `veo-3.0-generate-001` - Latest Veo model with improved quality
- `veo-3.0-fast-generate-001` - Fast video generation
- `veo-2.0-generate-001` - Previous generation video model

### Text-to-Speech Models

- `gemini-2.5-flash-preview-tts` - Flash model with TTS
- `gemini-2.5-pro-preview-tts` - Pro model with TTS

### Music Generation Models (Lyria)

- `lyria-realtime-exp` - Experimental real-time music generation model

## Using Embedding Models

Create embedding models that call the Google Generative AI embeddings API:

```typescript
const embedder = googleAI.embedder('gemini-embedding-001');
```

## Using Image Generation Models

Create image generation models using Imagen:

```typescript
const model = googleAI.model('imagen-4.0-generate-001');
```

## Provider Options

### Safety Settings

You can configure safety settings to control content filtering for different harm categories:

```typescript
const response = await ai.generate({
  model: googleAI.model('gemini-2.5-flash'),
  prompt: 'Your prompt here',
  config: {
    safetySettings: [
      {
        category: 'HARM_CATEGORY_HATE_SPEECH',
        threshold: 'BLOCK_MEDIUM_AND_ABOVE',
      },
      {
        category: 'HARM_CATEGORY_DANGEROUS_CONTENT',
        threshold: 'BLOCK_MEDIUM_AND_ABOVE',
      },
    ],
  },
});
```

Available harm categories:
- `HARM_CATEGORY_HATE_SPEECH`
- `HARM_CATEGORY_DANGEROUS_CONTENT`
- `HARM_CATEGORY_HARASSMENT`
- `HARM_CATEGORY_SEXUALLY_EXPLICIT`

Available thresholds:
- `HARM_BLOCK_THRESHOLD_UNSPECIFIED`
- `BLOCK_LOW_AND_ABOVE`
- `BLOCK_MEDIUM_AND_ABOVE`
- `BLOCK_ONLY_HIGH`
- `BLOCK_NONE`

### Thinking and Reasoning

Gemini 2.5 models use an internal thinking process that improves reasoning for complex tasks. You can control the thinking budget and access thought summaries:

```typescript
const response = await ai.generate({
  model: googleAI.model('gemini-2.5-flash'),
  prompt: 'What is the sum of the first 10 prime numbers?',
  config: {
    thinkingConfig: {
      thinkingBudget: 8192, // Number of thinking tokens
      includeThoughts: true, // Include thought summaries
    },
  },
});

console.log(response.text);
// Access reasoning summary if available
if (response.reasoning) {
  console.log('Reasoning:', response.reasoning);
}
```

For more information, see the [Google AI Thinking documentation](https://ai.google.dev/gemini-api/docs/thinking).

### File Inputs and YouTube URLs

Gemini models support various file types including PDFs and can process YouTube videos directly:

```typescript
import * as fs from 'fs';

// PDF file input
const pdfResponse = await ai.generate({
  model: googleAI.model('gemini-2.5-flash'),
  prompt: [
    { text: 'Summarize this document:' },
    {
      media: {
        contentType: 'application/pdf',
        url: `data:application/pdf;base64,${fs.readFileSync('./document.pdf', 'base64')}`,
      },
    },
  ],
});

// YouTube URL input
const videoResponse = await ai.generate({
  model: googleAI.model('gemini-2.5-flash'),
  prompt: [
    { text: 'Summarize this video:' },
    {
      media: {
        contentType: 'video/mp4',
        url: 'https://www.youtube.com/watch?v=VIDEO_ID',
      },
    },
  ],
});
```

:::note
YouTube URLs (public or unlisted videos) are supported directly. You can specify one YouTube video URL per request.
:::

### Context Caching

Gemini 2.5 models automatically cache common content prefixes, providing a 75% token discount on cached tokens:

```typescript
// Structure prompts with consistent content at the beginning
const baseContext = `You are a helpful cooking assistant with expertise in Italian cuisine.
Here is a comprehensive database of traditional Italian recipes and techniques...`.repeat(50);

// First request - content will be cached
const response1 = await ai.generate({
  model: googleAI.model('gemini-2.5-pro'),
  prompt: `${baseContext}\n\nCreate a vegetarian pasta recipe for 4 people.`,
});

// Second request with same prefix - eligible for cache hit and 75% discount
const response2 = await ai.generate({
  model: googleAI.model('gemini-2.5-pro'),
  prompt: `${baseContext}\n\nCreate a seafood pasta recipe for 6 people.`,
});
```

**Minimum token requirements for automatic caching:**
- Gemini 2.5 Flash: 1024 tokens
- Gemini 2.5 Pro: 2048 tokens

### Code Execution

Certain models can generate and execute Python code for calculations and problem-solving. Enable code execution in the model configuration:

```typescript
const response = await ai.generate({
  model: googleAI.model('gemini-2.5-pro'),
  prompt: 'Use Python to calculate the 20th Fibonacci number.',
  config: {
    codeExecution: true,
  },
});

console.log(response.text);
// The response will include code execution results
```

### Google Search Grounding

Enable Google Search to provide answers with current information. Configure it in the model config:

```typescript
const response = await ai.generate({
  model: googleAI.model('gemini-2.5-flash'),
  prompt: 'What are the top tech news stories this week?',
  config: {
    googleSearchRetrieval: true,
  },
});

console.log(response.text);
```

You can also pass custom configuration for Google Search:

```typescript
const response = await ai.generate({
  model: googleAI.model('gemini-2.5-flash'),
  prompt: 'What are the latest developments in AI?',
  config: {
    googleSearchRetrieval: {
      // Custom search configuration options
    },
  },
});
```

### Additional Tools via Pass-through

The Google GenAI plugin supports additional tools through the config's pass-through capability. You can provide custom tools in the `config.tools` array:

```typescript
// URL Context tool example
const response = await ai.generate({
  model: googleAI.model('gemini-2.5-flash'),
  prompt: 'Based on https://example.com/article, summarize the key points.',
  config: {
    tools: [
      {
        urlContext: {
          // URL context configuration
        },
      },
    ],
  },
});
```

:::note
You can add up to 20 URLs per request when using URL context. This feature is supported for Gemini 2.5 and Gemini 2.0 Flash models.
:::

You can combine multiple tools:

```typescript
const response = await ai.generate({
  model: googleAI.model('gemini-2.5-flash'),
  prompt: 'Based on https://example.com, tell me about this topic. Also provide latest news.',
  config: {
    googleSearchRetrieval: true,
    tools: [
      {
        urlContext: {},
      },
    ],
  },
});
```

### Image Generation Outputs

Models with image generation capabilities can create images:

```typescript
const response = await ai.generate({
  model: googleAI.model('gemini-2.5-flash-image-preview'),
  prompt: 'Create a picture of a futuristic city at sunset',
  config: {
    responseModalities: ['IMAGE'],
    imageConfig: {
      aspectRatio: '16:9', // Options: 1:1, 2:3, 3:2, 3:4, 4:3, 4:5, 5:4, 9:16, 16:9, 21:9
    },
  },
});

const generatedImage = response.media;
```

### Thinking Config

#### Thinking Level (Gemini 3.0)

```typescript
const response = await ai.generate({
  model: googleAI.model('gemini-3-pro-preview'),
  prompt: 'what is heavier, one kilo of steel or one kilo of feathers',
    config: {
      thinkingConfig: {
        thinkingLevel: 'HIGH',  // Or 'LOW' or 'MEDIUM'
    },
  },
});
```

#### Thinking Budget (Gemini 2.5)

```typescript
const { message } = await ai.generate({
  model: googleAI.model('gemini-2.5-pro'),
  prompt: 'what is heavier, one kilo of steel or one kilo of feathers',
  config: {
    thinkingConfig: {
      thinkingBudget: 1024,
      includeThoughts: true,
    },
  },
});
```

## Gemini API Features

The following features are available through the `googleAI` plugin.

### Gemini Files API

You can use files uploaded to the Gemini Files API with Genkit:

```ts
import { GoogleAIFileManager } from '@google/generative-ai/server';
import { genkit } from 'genkit';
import { googleAI } from '@genkit-ai/google-genai';

const ai = genkit({
  plugins: [googleAI()],
});

const fileManager = new GoogleAIFileManager(process.env.GEMINI_API_KEY);
const uploadResult = await fileManager.uploadFile('path/to/file.jpg', {
  mimeType: 'image/jpeg',
  displayName: 'Your Image',
});

const response = await ai.generate({
  model: googleAI.model('gemini-2.5-flash'),
  prompt: [
    { text: 'Describe this image:' },
    {
      media: {
        contentType: uploadResult.file.mimeType,
        url: uploadResult.file.uri,
      },
    },
  ],
});
```

### Video Generation (Veo) Models

The Google Generative AI plugin provides access to video generation capabilities through the Veo models. These models can generate videos from text prompts or manipulate existing images to create dynamic video content.

#### Basic Usage: Text-to-Video Generation

To generate a video from a text prompt using the Veo model:

```ts
import { googleAI } from '@genkit-ai/google-genai';
import * as fs from 'fs';
import { Readable } from 'stream';
import { MediaPart } from 'genkit';
import { genkit } from 'genkit';

const ai = genkit({
  plugins: [googleAI()],
});

ai.defineFlow('text-to-video-veo', async () => {
  let { operation } = await ai.generate({
    model: googleAI.model('veo-2.0-generate-001'),
    prompt: 'A majestic dragon soaring over a mystical forest at dawn.',
    config: {
      durationSeconds: 5,
      aspectRatio: '16:9',
    },
  });

  if (!operation) {
    throw new Error('Expected the model to return an operation');
  }

  // Wait until the operation completes.
  while (!operation.done) {
    operation = await ai.checkOperation(operation);
    // Sleep for 5 seconds before checking again.
    await new Promise((resolve) => setTimeout(resolve, 5000));
  }

  if (operation.error) {
    throw new Error('failed to generate video: ' + operation.error.message);
  }

  const video = operation.output?.message?.content.find((p) => !!p.media);
  if (!video) {
    throw new Error('Failed to find the generated video');
  }
  await downloadVideo(video, 'output.mp4');
});

async function downloadVideo(video: MediaPart, path: string) {
  const fetch = (await import('node-fetch')).default;
  // Add API key before fetching the video.
  const videoDownloadResponse = await fetch(`${video.media!.url}&key=${process.env.GEMINI_API_KEY}`);
  if (!videoDownloadResponse || videoDownloadResponse.status !== 200 || !videoDownloadResponse.body) {
    throw new Error('Failed to fetch video');
  }

  Readable.from(videoDownloadResponse.body).pipe(fs.createWriteStream(path));
}
```

Veo 3 uses the exact same API, just make sure you only use supported config options (see below).

To use the Veo 3 model, reference `veo-3.0-generate-001`:

```ts
let { operation } = await ai.generate({
  model: googleAI.model('veo-3.0-generate-001'),
  prompt: 'A cinematic shot of a an old car driving down a deserted road at sunset.',
});
```

For faster video generation, you can use the Veo 3 Fast model:

```ts
let { operation } = await ai.generate({
  model: googleAI.model('veo-3.0-fast-generate-001'),
  prompt: 'A cinematic shot of a an old car driving down a deserted road at sunset.',
});
```

#### Video Generation from Photo Reference

To use a photo as reference for the video using the Veo model (e.g. to make a static photo move), you can provide an image as part of the prompt.

```ts
const startingImage = fs.readFileSync('photo.jpg', { encoding: 'base64' });

let { operation } = await ai.generate({
  model: googleAI.model('veo-2.0-generate-001'),
  prompt: [
    {
      text: 'make the subject in the photo move',
    },
    {
      media: {
        contentType: 'image/jpeg',
        url: `data:image/jpeg;base64,${startingImage}`,
      },
    },
  ],
  config: {
    durationSeconds: 5,
    aspectRatio: '9:16',
    personGeneration: 'allow_adult',
  },
});
```

#### Configuration Options

The Veo models support various configuration options.

##### Veo Model Parameters

Full list of options can be found at https://ai.google.dev/gemini-api/docs/video#veo-model-parameters

- `negativePrompt`: Text string that describes anything you want to discourage the model from generating
- `aspectRatio`: Changes the aspect ratio of the generated video.
  - `"16:9"`: Supported in Veo 3 and Veo 2 (default for both).
  - `"9:16"`: Supported in Veo 2 only.
- `resolution`: Video resolution (Veo 3 only).
  - `"720p"`: 720p resolution (default, supported for both 16:9 and 9:16).
  - `"1080p"`: 1080p resolution (only supported for 16:9 aspect ratio).
- `personGeneration`: Allow the model to generate videos of people. The following values are supported:
  - **Text-to-video generation**:
    - `"allow_all"`: Generate videos that include adults and children. Currently the only available `personGeneration` value for Veo 3.
    - `"dont_allow"`: Veo 2 only. Don't allow the inclusion of people or faces.
    - `"allow_adult"`: Veo 2 only. Generate videos that include adults, but not children.
  - **Image-to-video generation**: Veo 2 only
    - `"dont_allow"`: Don't allow the inclusion of people or faces.
    - `"allow_adult"`: Generate videos that include adults, but not children.
- `numberOfVideos`: Output videos requested
  - `1`: Supported in Veo 3 and Veo 2
  - `2`: Supported in Veo 2 only.
- `durationSeconds`: Veo 2 only. Length of each output video in seconds, between 5 and 8. Not configurable for Veo 3, default setting is 8 seconds.
- `enhancePrompt`: Veo 2 only. Enable or disable the prompt rewriter. Enabled by default. Not configurable for Veo 3, default prompt enhancer is always on.

### Text-to-Speech (TTS) Models

The Google Genai plugin provides access to text-to-speech capabilities through Gemini TTS models. These models can convert text into natural-sounding speech for various applications.

#### Basic Usage

To generate audio using a TTS model:

```ts
import { googleAI } from '@genkit-ai/google-genai';
import { writeFile } from 'node:fs/promises';
import wav from 'wav'; // npm install wav && npm install -D @types/wav

const ai = genkit({
  plugins: [googleAI()],
});

const { media } = await ai.generate({
  model: googleAI.model('gemini-2.5-flash-preview-tts'),
  config: {
    responseModalities: ['AUDIO'],
    speechConfig: {
      voiceConfig: {
        prebuiltVoiceConfig: { voiceName: 'Algenib' },
      },
    },
  },
  prompt: 'Say that Genkit is an amazing Gen AI library',
});

if (!media) {
  throw new Error('no media returned');
}
const audioBuffer = Buffer.from(media.url.substring(media.url.indexOf(',') + 1), 'base64');
// The googleAI plugin returns raw PCM data, which we convert to WAV format.
await writeFile('output.wav', await toWav(audioBuffer));

async function toWav(pcmData: Buffer, channels = 1, rate = 24000, sampleWidth = 2): Promise<string> {
  return new Promise((resolve, reject) => {
    // This code depends on `wav` npm library.
    const writer = new wav.Writer({
      channels,
      sampleRate: rate,
      bitDepth: sampleWidth * 8,
    });

    let bufs = [] as any[];
    writer.on('error', reject);
    writer.on('data', function (d) {
      bufs.push(d);
    });
    writer.on('end', function () {
      resolve(Buffer.concat(bufs).toString('base64'));
    });

    writer.write(pcmData);
    writer.end();
  });
}
```

#### Multi-speaker Audio Generation

You can generate audio with multiple speakers, each with their own voice:

```ts
const response = await ai.generate({
  model: googleAI.model('gemini-2.5-flash-preview-tts'),
  config: {
    responseModalities: ['AUDIO'],
    speechConfig: {
      multiSpeakerVoiceConfig: {
        speakerVoiceConfigs: [
          {
            speaker: 'Speaker1',
            voiceConfig: {
              prebuiltVoiceConfig: { voiceName: 'Algenib' },
            },
          },
          {
            speaker: 'Speaker2',
            voiceConfig: {
              prebuiltVoiceConfig: { voiceName: 'Achernar' },
            },
          },
        ],
      },
    },
  },
  prompt: `Here's the dialog:
    Speaker1: "Genkit is an amazing Gen AI library!"
    Speaker2: "I thought it was a framework."`,
});
```

When using multi-speaker configuration, the model automatically detects speaker labels in the text (like "Speaker1:" and "Speaker2:") and applies the corresponding voice to each speaker's lines.

#### Configuration Options

The Gemini TTS models support various configuration options:

##### Voice Selection

You can choose from different pre-built voices with unique characteristics:

```ts
speechConfig: {
  voiceConfig: {
    prebuiltVoiceConfig: {
      voiceName: 'Algenib' // Other options: 'Achernar', 'Ankaa', etc.
    },
  },
}
```

##### Speech Emphasis

You can use markdown-style formatting in your prompt to add emphasis:

- Bold text (`**like this**`) for stronger emphasis
- Italic text (`*like this*`) for moderate emphasis

Example:

```ts
prompt: 'Genkit is an **amazing** Gen AI *library*!';
```

##### Advanced Speech Parameters


### Music Generation (Lyria RealTime)

The Google GenAI plugin provides access to real-time music generation through Lyria RealTime. This experimental model allows you to interactively create, continuously steer, and perform instrumental music using WebSocket-based streaming.

:::note
Lyria RealTime is an [experimental model](https://ai.google.dev/gemini-api/docs/models/experimental-models). The API and features may change.
:::

#### Basic Usage

To generate music using Lyria RealTime:

```ts
import { googleAI } from '@genkit-ai/google-genai';
import { genkit } from 'genkit';

const ai = genkit({
  plugins: [googleAI()],
});

// Note: Lyria RealTime uses WebSocket streaming
// This is a simplified example - see the full implementation in the cookbook
async function generateMusic() {
  // Connect to Lyria RealTime session
  const session = await ai.live.music.connect({
    model: 'models/lyria-realtime-exp',
    callbacks: {
      onmessage: (message) => {
        if (message.serverContent?.audioChunks) {
          // Process audio chunks (PCM16 format, 44.1kHz, stereo)
          for (const chunk of message.serverContent.audioChunks) {
            // Handle audio data
          }
        }
      },
    },
  });

  // Set initial prompts with weights
  await session.setWeightedPrompts({
    weightedPrompts: [
      { text: 'Minimal techno with deep bass', weight: 1.0 },
    ],
  });

  // Configure music generation
  await session.setMusicGenerationConfig({
    musicGenerationConfig: {
      bpm: 90,
      temperature: 1.0,
      audioFormat: 'pcm16',
      sampleRateHz: 44100,
    },
  });

  // Start streaming music
  await session.play();
}
```

#### Steering Music in Real-Time

You can dynamically change the music by sending new prompts while streaming:

```ts
// Update prompts to change the music style
await session.setWeightedPrompts({
  weightedPrompts: [
    { text: 'Piano', weight: 2.0 },
    { text: 'Meditation', weight: 0.5 },
    { text: 'Live Performance', weight: 1.0 },
  ],
});
```

#### Configuration Options

Lyria RealTime supports various configuration parameters:

```ts
await session.setMusicGenerationConfig({
  musicGenerationConfig: {
    bpm: 120,                    // Beats per minute (60-200)
    density: 0.75,               // Note density (0.0-1.0)
    brightness: 0.5,             // Tonal quality (0.0-1.0)
    guidance: 4.0,               // Prompt adherence (0.0-6.0)
    temperature: 1.1,            // Randomness (0.0-3.0)
    scale: 'C_MAJOR_A_MINOR',    // Musical scale
    muteBass: false,             // Mute bass
    muteDrums: false,            // Mute drums
    onlyBassAndDrums: false,     // Only bass and drums
    musicGenerationMode: 'QUALITY', // 'QUALITY', 'DIVERSITY', or 'VOCALIZATION'
  },
});
```

**Available Musical Scales:**
- `C_MAJOR_A_MINOR`, `D_FLAT_MAJOR_B_FLAT_MINOR`, `D_MAJOR_B_MINOR`
- `E_FLAT_MAJOR_C_MINOR`, `E_MAJOR_D_FLAT_MINOR`, `F_MAJOR_D_MINOR`
- `G_FLAT_MAJOR_E_FLAT_MINOR`, `G_MAJOR_E_MINOR`, `A_FLAT_MAJOR_F_MINOR`
- `A_MAJOR_G_FLAT_MINOR`, `B_FLAT_MAJOR_G_MINOR`, `B_MAJOR_A_FLAT_MINOR`
- `SCALE_UNSPECIFIED` (model decides)

#### Playback Controls

Control the music stream with these methods:

```ts
await session.play();          // Start/resume playback
await session.pause();         // Pause playback
await session.stop();          // Stop playback
await session.resetContext();  // Reset context (needed for BPM/scale changes)
```

#### Prompt Examples

Lyria RealTime supports various musical concepts:

**Instruments:**
- `303 Acid Bass`, `808 Hip Hop Beat`, `Accordion`, `Guitar`, `Piano`, `Synth Pads`, `Trumpet`, `Violin`

**Genres:**
- `Minimal Techno`, `Jazz Fusion`, `Ambient`, `Classical`, `Hip Hop`, `EDM`, `Bossa Nova`

**Moods:**
- `Chill`, `Energetic`, `Dark`, `Uplifting`, `Melancholic`, `Dreamy`

**Example Prompts:**
```ts
// Combine multiple elements
await session.setWeightedPrompts({
  weightedPrompts: [
    { text: 'Minimal techno', weight: 1.0 },
    { text: 'Deep bass', weight: 0.8 },
    { text: 'Atmospheric synths', weight: 0.6 },
  ],
});
```

#### Audio Output Specifications

- **Format:** Raw 16-bit PCM Audio
- **Sample Rate:** 48kHz (configurable to 44.1kHz)
- **Channels:** 2 (stereo)
- **Latency:** Real-time streaming with low latency

:::note
For complete working examples, see the [Lyria RealTime Cookbook](https://github.com/google-gemini/cookbook/blob/main/quickstarts/Get_started_LyriaRealTime.py) and try the [Prompt DJ](https://aistudio.google.com/apps/bundled/promptdj) or [MIDI DJ](https://aistudio.google.com/apps/bundled/promptdj-midi) apps in AI Studio.
:::

For more detailed information, see the [Google AI Music Generation documentation](https://ai.google.dev/gemini-api/docs/music-generation).

For more control over the generated speech:

```ts
speechConfig: {
  voiceConfig: {
    prebuiltVoiceConfig: {
      voiceName: 'Algenib',
      speakingRate: 1.0,  // Range: 0.25 to 4.0, default is 1.0
      pitch: 0.0,         // Range: -20.0 to 20.0, default is 0.0
      volumeGainDb: 0.0,  // Range: -96.0 to 16.0, default is 0.0
    },
  },
}
```

- `speakingRate`: Controls the speed of speech (higher values = faster speech)
- `pitch`: Adjusts the pitch of the voice (higher values = higher pitch)
- `volumeGainDb`: Controls the volume (higher values = louder)

For more detailed information about the Gemini TTS models and their configuration options, see the [Google AI Speech Generation documentation](https://ai.google.dev/gemini-api/docs/speech-generation).

## Troubleshooting

### Schema Limitations

The Google Generative AI API uses a subset of the OpenAPI 3.0 schema, which does not support certain features like unions. If you encounter schema-related errors, you may need to adjust your schema:

```typescript
// Error example:
// GenerateContentRequest.generation_config.response_schema.properties[field].type: must be specified

// Workaround: Simplify schema or avoid unsupported features
const response = await ai.generate({
  model: googleAI.model('gemini-2.5-flash'),
  output: {
    schema: z.object({
      name: z.string(),
      age: z.number(),
      // Avoid z.union, z.record, and other unsupported features
    }),
  },
  prompt: 'Generate a person profile',
});
```

Known Zod features that may not work:
- `z.union()` - Use alternatives like separate fields
- `z.record()` - Use explicit object properties instead

### Rate Limits

If you encounter rate limit errors, consider:
- Implementing exponential backoff retry logic
- Using batch operations where available
- Upgrading your API quota in Google AI Studio

### API Key Issues

Ensure your API key is properly configured:
- Set the `GEMINI_API_KEY` or `GOOGLE_API_KEY` environment variable
- Or pass the key directly in plugin configuration: `googleAI({ apiKey: 'your-key' })`
- Get your API key from [Google AI Studio](https://aistudio.google.com/apikey)

## Next Steps

- Learn about [generating content](/docs/models) to understand how to use these models effectively
- Explore [creating flows](/docs/flows) to build structured AI workflows
- To use the Gemini API at enterprise scale or leverage Vertex vector search and Model Garden, see the [Vertex AI plugin](/docs/integrations/vertex-ai)

</LanguageContent>

<LanguageContent lang="go">

The Google Generative AI plugin provides interfaces to Google's Gemini models through the Gemini API.

## Configuration

To use this plugin, import the `googlegenai` package and pass
`googlegenai.GoogleAI` to `WithPlugins()` in the Genkit initializer:

```go
import "github.com/firebase/genkit/go/plugins/googlegenai"
```

```go
g := genkit.Init(context.Background(), genkit.WithPlugins(&googlegenai.GoogleAI{}))
```

The plugin requires an API key for the Gemini API, which you can get from
[Google AI Studio](https://aistudio.google.com/app/apikey).

Configure the plugin to use your API key by doing one of the following:

- Set the `GEMINI_API_KEY` environment variable to your API key.

- Specify the API key when you initialize the plugin:

  ```go
  genkit.WithPlugins(&googlegenai.GoogleAI{APIKey: "YOUR_API_KEY"})
  ```

  However, don't embed your API key directly in code! Use this feature only
  in conjunction with a service like Cloud Secret Manager or similar.

## Usage

### Generative models

To get a reference to a supported model, specify its identifier to `googlegenai.GoogleAIModel`:

```go
model := googlegenai.GoogleAIModel(g, "gemini-2.5-flash")
```

Alternatively, you may create a `ModelRef` which pairs the model name with its config:

```go
modelRef := googlegenai.GoogleAIModelRef("gemini-2.5-flash", &genai.GenerateContentConfig{
	Temperature: genai.Ptr[float32](0.5),
	MaxOutputTokens: genai.Ptr[int32](500),
	// Other configuration...
})
```

Model references have a `Generate()` method that calls the Google API:

```go
resp, err := genkit.Generate(ctx, g, ai.WithModel(modelRef), ai.WithPrompt("Tell me a joke."))
if err != nil {
	return err
}

log.Println(resp.Text())
```

See [Generating content with AI models](/docs/models) for more information.

### Embedding models

To get a reference to a supported embedding model, specify its identifier to `googlegenai.GoogleAIEmbedder`:

```go
embeddingModel := googlegenai.GoogleAIEmbedder(g, "text-embedding-004")
```

Embedder references have an `Embed()` method that calls the Google AI API:

```go
resp, err := genkit.Embed(ctx, g, ai.WithEmbedder(embeddingModel), ai.WithTextDocs(userInput))
if err != nil {
	return err
}
```

See [Retrieval-augmented generation (RAG)](/docs/rag) for more information.

## Next Steps

- Learn about [generating content](/docs/models) to understand how to use these models effectively
- Explore [creating flows](/docs/flows) to build structured AI workflows
- To use the Gemini API at enterprise scale see the [Vertex AI plugin](/docs/integrations/vertex-ai)

</LanguageContent>

<LanguageContent lang="python">

The `genkit-plugin-google-genai` package provides the `GoogleAI` plugin for accessing Google's generative AI models via the Google Gemini API (requires an API key).

## Installation

```bash
pip3 install genkit-plugin-google-genai
```

## Configuration

To use the Google Gemini API, you need an API key.

```python
from genkit.ai import Genkit
from genkit.plugins.google_genai import GoogleAI

ai = Genkit(
  plugins=[GoogleAI()],
  model='googleai/gemini-2.5-flash',
)
```

You will need to set GEMINI_API_KEY environment variable or you can provide the API Key directly:

```python
ai = Genkit(
  plugins=[GoogleAI(api_key='...')]
)
```

## Usage

### Text Generation

```python
response = await ai.generate('What should I do when I visit Melbourne?')
print(response.text)
```

### Text Embedding

```python
embeddings = await ai.embed(
    embedder='googleai/text-embedding-004',
    content='How many widgets do you have in stock?',
)
```

### Image Generation

```python
response = await ai.generate(
    model='googleai/imagen-4.0-generate-001',
    prompt='a banana riding a bicycle',
)
```

## Next Steps

- Learn about [generating content](/docs/models) to understand how to use these models effectively
- Explore [creating flows](/docs/flows) to build structured AI workflows
- To use the Gemini API at enterprise scale see the [Vertex AI plugin](/docs/integrations/vertex-ai)

</LanguageContent>
