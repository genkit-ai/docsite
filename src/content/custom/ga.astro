---
export interface Props {
  bannerForceDarkMode?: boolean;
}

const { bannerForceDarkMode = false } = Astro.props;
---

<!-- Google tag (gtag.js) -->
<script
  type="application/javascript"
  async
  src="https://www.googletagmanager.com/gtag/js?id=G-T0FC3Y6PQX"></script>
<script define:vars={{ bannerForceDarkMode }}>
  window.dataLayer = window.dataLayer || [];
  function gtag() {
    dataLayer.push(arguments);
  }
  gtag("js", new Date());
  gtag("config", "G-T0FC3Y6PQX");

  const gaAck = localStorage.getItem("gaAck");
  if (gaAck !== "true") {
    var bannerRoot = document.createElement("div");
    bannerRoot.setAttribute("id", "gaBanner");
    bannerRoot.className =
      "flex justify-center fixed bottom-4 max-md:bottom-0 left-0 right-0";
    
    // Determine styling based on prop
    const bannerClasses = bannerForceDarkMode ? 'bg-black text-white border-white/20' : 'bg-white dark:bg-black text-black dark:text-white border-black/20 dark:border-white/20';
    const linkClasses = bannerForceDarkMode ? 'text-white underline' : 'text-black dark:text-white underline';
    const buttonClasses = bannerForceDarkMode ? 'bg-black border border-white/30 text-white' : 'bg-white dark:bg-black border border-black/30 dark:border-white/30 text-black dark:text-white';
    
    bannerRoot.innerHTML =
      `<div class="flex p-2 gap-x-4 max-md:rounded-none max-md:border-none max-md:border-t items-center ${bannerClasses} text-sm justify-center rounded-lg border"><div class="text-balance">This site uses <a href="https://policies.google.com/technologies/cookies" target="_blank" class="${linkClasses}">cookies</a> from Google to deliver and enhance the quality of its services and to analyze traffic.</div> <button class="text-accent py-1 px-2 rounded no-wrap ${buttonClasses}" onclick="document.genkitAckGaBanner()">I&nbsp;Understand</button></div>`;
    document.body.appendChild(bannerRoot);
    document.genkitAckGaBanner = function () {
      localStorage.setItem("gaAck", "true");
      document.getElementById("gaBanner").remove();
    };
  }
</script>
