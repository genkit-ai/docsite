---
import StarlightPage from '@astrojs/starlight/components/StarlightPage.astro';
import { marked } from 'marked';

interface Release {
  name: string;
  html_url: string;
  published_at: string;
  body: string;
}

const response = await fetch('https://api.github.com/repos/firebase/genkit/releases');
const releases: Release[] = await response.json();
---

<StarlightPage frontmatter={{ title: 'Changelog' }}>
  {
    releases.map((release) => (
      <div class="sl-markdown-content">
        <h2>{release.name}</h2> ({new Date(release.published_at).toLocaleDateString()})
        <div class="release-body" set:html={marked.parse(release.body)} />
        <hr />
      </div>
    ))
  }
</StarlightPage>
