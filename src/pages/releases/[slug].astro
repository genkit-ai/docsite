---
import StarlightPage from '@astrojs/starlight/components/StarlightPage.astro';
import { marked } from 'marked';

export async function getStaticPaths() {
  const response = await fetch('https://api.github.com/repos/firebase/genkit/releases');
  const releases: any[] = await response.json();

  return releases.map((release) => ({
    params: { slug: release.name.replace(/ /g, '_') },
    props: { release },
  }));
}

const { release } = Astro.props;
---

<StarlightPage frontmatter={{ title: release.name }}>
  <div class="sl-markdown-content">
    <h2>{release.name}</h2> ({new Date(release.published_at).toLocaleDateString()})
    <div class="release-body" set:html={marked.parse(release.body)} />
  </div>
</StarlightPage>
